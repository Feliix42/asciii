<h1>asciii web</h1>

<Years years={years} on:select="selectYear(event.year)"/>

<h2> {#if selectedYear} {selectedYear} {/if} </h2>

<ProjectList projects={projects} on:select="selectProject(event.project)"/>

{#if selectedProject}
    <ProjectView project={selectedProject}/>
{/if}

<style>
</style>

<script>
    import ProjectList from './ProjectList.html';
    import ProjectView from './ProjectView.html';
    import Years from './Years.html';
    import { getProjectsByYear, getProjectsWorkingDir } from './getters';

    export default {
        components: { ProjectList, Years, ProjectView },
        onstate(diff) {
            console.dir(diff);
        },
        methods: {
            async selectYear(selectedYear) {
                if (selectedYear === 'working') {
                    this.set({ selectedYear });
                    this.set({ projects: await getProjectsWorkingDir() });
                } else {
                    this.set({ selectedYear });
                    this.set({ projects: await getProjectsByYear(selectedYear) });
                }
            },

            selectProject(selectedProject) {
                this.set({selectedProject})
            }
        }
    };
</script>