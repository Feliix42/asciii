<style>

    #project-list {
        min-width: 40em
    }

    #projects {
        height: 250px;
        max-height: 250px;
        overflow: scroll;
    }

    td.checkbox {
        text-align: center;
        width: 20px;
        overflow: hidden;
        display: inline-block;
        white-space: nowrap;
    }
</style>


<input bind:value=search /> {filteredProjects.length}

<div id="projects">
<table id="project-list">
    {#each filteredProjects as [key, project], index}
    <tr on:click="fire('select', {project})">
        <td>{index + 1}</td>
        <td>{project.event.name}</td>
        <td>{project.event.manager}</td>
        <td>{project.invoice.number || ''}</td>
        <td>{project.event.date}</td>
        <td class="checkbox">{project.checks.ready_for_offer ? '✔' : '𝘅'}</td>
        <td class="checkbox">{project.checks.ready_for_invoice ? '✔' : '𝘅'}</td>
        <td class="checkbox">{project.checks.ready_for_archive ? '✔' : '𝘅'}</td>
        <td class="checkbox">{project.checks.payed_by_customer ? '✔' : '𝘅'}</td>
    </tr>
    {/each}
</table>
</div>

<script>
    export default {
        methods: {
            select(project) {
                console.dir({ project });
                this.fire(selectProject, project);
            }
        },
        data() {
            return {
                search: ''
            };
        },
        computed: {
            filteredProjects: ({ search, projects }) => {
                search = search.toLowerCase();
                return projects.filter(([, project]) => {
                    const name = project.event.name && project.event.name.toLowerCase()
                    const manager = project.event.manager.toLowerCase()
                    return (
                        name && name.includes(search)
                        || manager.includes(search)
                    )
                });
            },
        }
    };
</script>